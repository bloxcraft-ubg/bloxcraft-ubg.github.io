<!-- Copyright (c) Bloxcraft Studios 2025 -->
<!-- NEW TAB ONLY WORKS ON PROXY -->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Bloxcraft UBG - Proxy - New Tab</title>
<link rel="shortcut icon" type="image/png" href="/bloxcraft.png">
<style>
body {
  color: white;
  background: linear-gradient(to bottom right,#1a1a1a,#3333cc);
  font-family: Arial, sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding-top: 50px;
  margin: 0;
  height: 100vh;
}
h1 { font-size: 48px; margin-bottom: 40px; }
#search-bar { display: flex; margin-bottom: 40px; }
#search-bar input {
  width: 400px;
  padding: 12px 20px;
  font-size: 16px;
  border-radius: 8px 0 0 8px;
  border: none;
  outline: none;
}
#search-bar button {
  padding: 12px 20px;
  font-size: 16px;
  background: linear-gradient(to bottom,#0077c2,#005f9c);
  border: none;
  border-radius: 0 8px 8px 0;
  cursor: pointer;
  color: white;
}
#search-bar button:hover { background: linear-gradient(to bottom,#0088e0,#006eb5); }
.app-row {
  display: flex;
  gap: 25px;
  flex-wrap: nowrap;
  overflow-x: auto;
  padding: 10px;
  max-width: 90%;
}
.app-row::-webkit-scrollbar { display: none; }
.app-btn {
  flex: 0 0 auto;
  display: flex;
  flex-direction: column;
  align-items: center;
  background: rgba(255,255,255,0.1);
  border-radius: 15px;
  padding: 15px;
  width: 100px;
  cursor: pointer;
  transition: transform 0.2s, background 0.2s;
}
.app-btn:hover { background: rgba(255,255,255,0.25); transform: scale(1.1); }
.app-btn img { width: 60px; height: 60px; margin-bottom: 10px; }
.app-btn span { font-size: 14px; text-align: center; }
</style>
</head>
<body>
<h1>Bloxcraft UBG New Tab</h1>

<div id="search-bar">
  <input id="search" placeholder="Type a URL or search term..." />
  <button id="search-btn">Go âž¤</button>
</div>

<div class="app-row" id="appRow"></div>

<script>
const WORKER_URLS = [
  'https://school-static.sweet-dawn-d933.workers.dev/',
  'https://school-static.bs-bloxcraft.workers.dev/',
  'https://school-static.bs-minecraft-pe.workers.dev/'
];

const apps = [
  { name: 'YouTube', url: 'https://www.youtube.com', icon: 'https://upload.wikimedia.org/wikipedia/commons/b/b8/YouTube_Logo_2017.svg' },
  { name: 'Google', url: 'https://www.google.com', icon: 'https://upload.wikimedia.org/wikipedia/commons/2/2f/Google_2015_logo.svg' },
  { name: 'Discord', url: 'https://discord.com', icon: 'https://cdn.prod.website-files.com/6257adef93867e50d84d30e2/67d00cf7266d2c75571aebde_Example.svg' }
];

const appRow = document.getElementById('appRow');
apps.forEach(app => {
  const btn = document.createElement('div');
  btn.className = 'app-btn';
  btn.innerHTML = `<img src="${app.icon}" alt="${app.name}"><span>${app.name}</span>`;
  btn.addEventListener('click', () => {
    openInProxy(app.url);
  });
  appRow.appendChild(btn);
});

// Format input: URL or Google search
function formatUrl(input) {
  if(!input) return '';
  input = input.trim();
  if(input.startsWith('bloxcraft://newtab')) return 'https://bloxcraft-ubg.pages.dev/proxy/new-tab/';
  if(input.startsWith('http://') || input.startsWith('https://')) return input;
  return 'https://www.google.com/search?q=' + encodeURIComponent(input);
}

// Try workers
async function tryWorkers(url) {
  for(const worker of WORKER_URLS) {
    try {
      const test = await fetch(`${worker}?url=${encodeURIComponent(url)}`, { method:'HEAD' });
      if(test.ok) return worker;
    } catch(e) { console.log(`Worker failed: ${worker}`, e); }
  }
  return null;
}

// Open link in parent proxy iframe
async function openInProxy(input) {
  const url = formatUrl(input);
  const worker = await tryWorkers(url);
  if(!worker) { alert('ERROR: All proxy stations are blocked.'); return; }
  if(window.opener && window.opener.iframe) {
    window.opener.iframe.src = `${worker}?url=${encodeURIComponent(url)}`;
  } else {
    // fallback if page not opened from main proxy
    window.open(`${worker}?url=${encodeURIComponent(url)}`, '_blank');
  }
}

// Search bar
const searchInput = document.getElementById('search');
const searchBtn = document.getElementById('search-btn');
searchBtn.addEventListener('click', () => openInProxy(searchInput.value));
searchInput.addEventListener('keydown', e => { if(e.key==='Enter') openInProxy(searchInput.value); });

</script>
</body>
</html>
