<!-- Copyright (c) 2025 Bloxcraft Studios -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bloxcraft UBG - Browse Mode</title>
      <meta name="description" content="The Unblocked Games Site For You To Play!">
<meta property="og:title" content="Bloxcraft UBG Games">
<meta property="og:type" content="article">
<meta property="og:url" content="/">
<meta property="og:site_name" content="Bloxcraft UBG">
<meta property="og:image" content="/gamepage_banner.png" />
<meta name="theme-color" content="#5555FF"> 
<meta property="og:description" content="The Unblocked Games Site You Can Play Everyday! It Also has Some Custom Games.">
  <link rel="shortcut icon" type="image/png" href="/bloxcraft.png">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<style>
  body {
    margin: 0;
    font-family: 'Orbitron', sans-serif;
    color: #fff;
    display: flex;
    flex-direction: column;
    height: 100vh;
    background: linear-gradient(135deg, #1e3c72, #2a5298);
  }

  .tabs {
    display: flex;
    background: linear-gradient(90deg, #4facfe, #00f2fe);
    padding: 5px;
    overflow-x: auto;
    z-index: 100;
  }
  .tab {
    display: flex;
    align-items: center;
    background: rgba(255,255,255,0.2);
    padding: 5px 10px;
    margin-right: 5px;
    border-radius: 5px;
    cursor: pointer;
    white-space: nowrap;
  }
  .tab.active {
    background: rgba(255,255,255,0.5);
    font-weight: bold;
  }
  .tab img {
    width: 16px;
    height: 16px;
    margin-right: 5px;
    display: none;
  }
  .tab-close {
    margin-left: 8px;
    cursor: pointer;
    font-weight: bold;
  }
  .add-tab {
    font-size: 20px;
    padding: 0 10px;
    cursor: pointer;
  }


  .controls {
    display: flex;
    padding: 10px;
    background: rgba(0,0,0,0.3);
    align-items: center;
    gap: 10px;
    z-index: 99;
  }
  .url-bar {
    flex: 1;
    background: rgba(255,255,255,0.2);
    border: none;
    color: #fff;
    padding: 8px 12px;
    border-radius: 5px;
    font-size: 14px;
    pointer-events: none;
  }
  .refresh-btn, .fullscreen-btn {
    padding: 8px 12px;
    border: none;
    border-radius: 5px;
    background: #4facfe;
    color: #fff;
    cursor: pointer;
    font-weight: bold;
  }


  iframe {
    flex: 1;
    border: none;
    width: 100%;
    transition: all 0.3s;
  }

 
  .iframe-fullscreen {
    position: fixed !important;
    top: 0;
    left: 0;
    width: 100vw !important;
    height: 100vh !important;
    z-index: 9999;
  }


  @media (max-width: 768px) {
    .tabs {
      flex-wrap: wrap;
    }
    .controls {
      flex-direction: column;
      align-items: stretch;
    }
    .refresh-btn, .fullscreen-btn {
      width: 100%;
      margin-top: 5px;
    }
  }
</style>
</head>
<body>

<div class="tabs" id="tabs">
  <div class="add-tab" id="addTab">+</div>
</div>

<div class="controls" id="controls">
  <input type="text" id="urlBar" class="url-bar" value="bloxcraft://newtab" readonly>
  <button class="refresh-btn" id="refreshBtn">⟳ Refresh</button>
  <button class="fullscreen-btn" id="fullscreenBtn">⛶ Fullscreen</button>
</div>
  <p>Copyright (c) 2025 Bloxcraft Studios</p>

<iframe id="browserFrame" src="/assets/home/newtab/index.html"></iframe>

<script>
  const tabsContainer = document.getElementById('tabs');
  const addTabBtn = document.getElementById('addTab');
  const urlBar = document.getElementById('urlBar');
  const browserFrame = document.getElementById('browserFrame');
  const refreshBtn = document.getElementById('refreshBtn');
  const fullscreenBtn = document.getElementById('fullscreenBtn');
  const controls = document.getElementById('controls');

  let tabs = [];
  let currentTabId = 0;
  let tabCount = 0;

  const defaultPages = {
    '/': '/assets/home/index.html',
    '/games': '/assets/games/index.html',
    '/featured-games': '/assets/featured-games/index.html',
    '/refined-beta': '/assets/refined-beta/index.html',
    '/assets/home/newtab/index.html': '/assets/home/newtab/index.html'
  };

  function createTab(src, label) {
    const tabId = tabCount++;
    const tab = { id: tabId, src: src, label: label || "New Tab" };
    tabs.push(tab);

    const tabElem = document.createElement('div');
    tabElem.className = 'tab';
    tabElem.id = 'tab-' + tabId;

    const favicon = document.createElement('img');
    favicon.alt = '';
    tabElem.appendChild(favicon);

    const spanLabel = document.createElement('span');
    spanLabel.textContent = tab.label;
    tabElem.appendChild(spanLabel);

    const closeBtn = document.createElement('span');
    closeBtn.className = 'tab-close';
    closeBtn.textContent = '×';
    tabElem.appendChild(closeBtn);

    tabsContainer.insertBefore(tabElem, addTabBtn);

    tabElem.addEventListener('click', (e) => {
      if (e.target.classList.contains('tab-close')) {
        closeTab(tabId);
      } else {
        switchTab(tabId);
      }
    });

    switchTab(tabId);
  }

  function switchTab(id) {
    currentTabId = id;
    const tab = tabs.find(t => t.id === id);
    browserFrame.src = tab.src;
    updateTabAndUrl(tab);
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    const activeTabElem = document.getElementById('tab-' + id);
    if (activeTabElem) activeTabElem.classList.add('active');
  }

  function updateTabAndUrl(tab) {
    try {
      const iframeDoc = browserFrame.contentDocument || browserFrame.contentWindow.document;

      
      const title = iframeDoc.title || tab.label;
      const tabElem = document.getElementById('tab-' + tab.id);
      tabElem.querySelector('span').textContent = title;

    
      const linkIcon = iframeDoc.querySelector("link[rel~='icon']");
      const img = tabElem.querySelector('img');
      if (linkIcon) {
        img.src = linkIcon.href;
        img.style.display = 'inline-block';
      } else {
        img.style.display = 'none';
      }

    
      const path = new URL(browserFrame.contentWindow.location.href, window.location.origin).pathname;
      urlBar.value = 'bloxcraft:/' + (path === '/assets/home/newtab/index.html' ? 'newtab' : path.replace(/^\/|\/$/g, '') || 'home');

    } catch(err) {
     
      const tabElem = document.getElementById('tab-' + tab.id);
      tabElem.querySelector('img').style.display = 'none';
      tabElem.querySelector('span').textContent = tab.label;
      urlBar.value = getBloxcraftURL(tab.src);
    }
  }

  function closeTab(id) {
    const index = tabs.findIndex(t => t.id === id);
    if (index > -1) {
      tabs.splice(index, 1);
      const tabElem = document.getElementById('tab-' + id);
      if (tabElem) tabElem.remove();
      if (currentTabId === id && tabs.length > 0) {
        switchTab(tabs[0].id);
      } else if (tabs.length === 0) {
        createTab('/assets/home/newtab/index.html', 'New Tab');
      }
    }
  }

  function getBloxcraftURL(src) {
    for (const [key, val] of Object.entries(defaultPages)) {
      if (val === src) {
        return 'bloxcraft:/' + (key === '/assets/home/newtab/index.html' ? 'newtab' : key.replace('/', '') || 'home');
      }
    }
    return src;
  }

  addTabBtn.addEventListener('click', () => {
    createTab('/assets/home/newtab/index.html', 'New Tab');
  });

  refreshBtn.addEventListener('click', () => {
    const tab = tabs.find(t => t.id === currentTabId);
    if (tab) browserFrame.src = tab.src;
  });

  fullscreenBtn.addEventListener('click', () => {
    browserFrame.classList.toggle('iframe-fullscreen');
    controls.style.display = browserFrame.classList.contains('iframe-fullscreen') ? 'none' : 'flex';
    tabsContainer.style.display = browserFrame.classList.contains('iframe-fullscreen') ? 'none' : 'flex';
  });


  const isMobile = /Mobi|Android/i.test(navigator.userAgent);
  if (isMobile) {
    tabsContainer.style.flexWrap = 'wrap';
    urlBar.style.fontSize = '16px';
  }


  browserFrame.addEventListener('load', () => {
    const tab = tabs.find(t => t.id === currentTabId);
    if (tab) updateTabAndUrl(tab);
  });


  createTab('/assets/home/newtab/index.html', 'New Tab');
</script>
</body>
</html>
